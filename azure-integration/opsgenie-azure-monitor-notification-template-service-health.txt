---------------------
MESSAGE TEMPLATE
---------------------

ğŸš¨ Azure Service Health Alert: [ {{_payload.data.context.activityLog.properties.title}} ] - Status: [ {{_payload.data.context.activityLog.status}} ] ğŸš¨

---------------------
FILTER TEMPLATE
---------------------

NOTE: confliciting consumption of schemaId

Match All Conditions Below
* Schema ID = Microsoft.Insights/activityLogs
* ? contains Microsoft.ServiceHealth

---------------------
PRIORITY TEMPLATE
---------------------

P{{severity.extract(/Sev([1-5])/)}}

---------------------
NOTIFICATION TEMPLATE
---------------------

ğŸ”” Service Health Alert Notification ğŸ””

ğŸš© Alert Details:
- Status: {{_payload.data.status}}
- Event Source: {{_payload.data.context.activityLog.eventSource}}
- Level: {{_payload.data.context.activityLog.level}}
- Operation Name: {{_payload.data.context.activityLog.operationName}}
- Operation ID: {{_payload.data.context.activityLog.operationId}}
- Subscription ID: {{_payload.data.context.activityLog.subscriptionId}}
- Correlation ID: {{_payload.data.context.activityLog.correlationId}}

ğŸ“… Event Timestamp: {{_payload.data.context.activityLog.eventTimestamp}}
ğŸ†” Event Data ID: {{_payload.data.context.activityLog.eventDataId}}

ğŸ“¢ Communication:
{{_payload.data.context.activityLog.properties.communication}}

ğŸ“ Incident Details:
- Title: {{_payload.data.context.activityLog.properties.title}}
- Service: {{_payload.data.context.activityLog.properties.service}}
- Region: {{_payload.data.context.activityLog.properties.region}}
- Incident Type: {{_payload.data.context.activityLog.properties.incidentType}}
- Tracking ID: {{_payload.data.context.activityLog.properties.trackingId}}
- Impact Start Time: {{_payload.data.context.activityLog.properties.impactStartTime}}
- Impact Mitigation Time: {{_payload.data.context.activityLog.properties.impactMitigationTime}}
- Impacted Services: {{_payload.data.context.activityLog.properties.impactedServices.get(0).substringBetween("ServiceName=", "}")}}
- Impacted Regions: {{_payload.data.context.activityLog.properties.impactedServices.get(0).substringBetween("ImpactedRegions=[", "]")}}

ğŸ”— [View Alert Details on Azure Portal](https://portal.azure.com)

----
ğŸ” Full Payload:
{{_payload}}
