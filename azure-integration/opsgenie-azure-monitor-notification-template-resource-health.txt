---------------------
MESSAGE TEMPLATE
---------------------

ğŸš¨ Azure Resource Health Alert: [ {{_payload.data.context.activityLog.operationName}} ] - RG: [ {{_payload.data.context.activityLog.resourceGroupName}} ] - Status: [ {{_payload.data.context.activityLog.status}} ] ğŸš¨

---------------------
FILTER TEMPLATE
---------------------

NOTE: confliciting consumption of schemaId

Match All Conditions Below
* Schema ID = Microsoft.Insights/activityLogs
* ? contains Microsoft.Resourcehealth


---------------------
PRIORITY TEMPLATE
---------------------

P{{severity.extract(/Sev([1-5])/)}}

---------------------
NOTIFICATION TEMPLATE
---------------------

ğŸ”” Azure Resource Health Alert Notification ğŸ””

ğŸš© Alert Details:
- Status: {{_payload.data.context.activityLog.status}}
- Alert Rule: {{_payload.data.context.activityLog.operationName}}
- Caller: {{_payload.data.context.activityLog.caller}}
- Resource Group: {{_payload.data.context.activityLog.resourceGroupName}}


ğŸ“… Alert Timestamp: {{_payload.data.context.activityLog.eventTimestamp}}
ğŸ” Event Source: {{_payload.data.context.activityLog.eventSource}}
ğŸ”§ Level: {{_payload.data.context.activityLog.level}}
ğŸ“‹ Description: {{_payload.data.context.activityLog.description}}

ğŸ¥ Service Health Details:
Health Status: {{_payload.data.context.activityLog.properties.currentHealthStatus}}
Previous Health Status: {{_payload.data.activityLog.context.properties.previousHealthStatus}}
Type: {{_payload.data.context.activityLog.properties.type}}
Cause: {{_payload.data.context.activityLog.properties.cause}}

ğŸ” Activity Log Details:
- Operation ID: {{_payload.data.context.activityLog.operationId}}
- Correlation ID: {{_payload.data.context.activityLog.correlationId}}
- Caller: {{_payload.data.context.activityLog.caller}}
- Subscription ID: {{_payload.data.context.activityLog.subscriptionId}}
- Resource ID: {{_payload.data.context.activityLog.resourceId}}
- Resource Type: {{_payload.data.context.activityLog.resourceType}}
- Resource Group: {{_payload.data.context.activityLog.resourceGroupName}}
- Status: {{_payload.data.context.activityLog.status}}

ğŸ“ Custom Properties:
{{_payload.data.properties}}

ğŸŒ Resource Information:
- Resource ID: {{_payload.data.context.activityLog.resourceId}}
- Resource Type: {{_payload.data.context.activityLog.resourceType}}
- Resource Group: {{_payload.data.context.activityLog.resourceGroupName}}
- Resource Provider: {{_payload.data.context.activityLog.resourceProviderName}}

ğŸ”— [View Alert Details on Azure Portal]({{portal_link}})

----
ğŸ” Full Payload:
{{_payload.data}}